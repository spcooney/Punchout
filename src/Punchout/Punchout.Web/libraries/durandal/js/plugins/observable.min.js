define(["durandal/system","durandal/binder","knockout"],function(n,t,i){function rt(n){var t=n[0];return t==="_"||t==="$"||f&&n===f}function ut(t){return!!(t&&t.nodeType!==undefined&&n.isNumber(t.nodeType))}function ft(n){if(!n||ut(n)||n.ko===i||n.jquery)return!1;var t=b.call(n);return k.indexOf(t)==-1&&!(n===!0||n===!1)}function c(n){var t={};return Object.defineProperty(n,"__observable__",{enumerable:!1,configurable:!1,writable:!1,value:t}),t}function e(n,t,i){var f=n.__observable__,u=!0,e,s;if(!f||!f.__full__)for(f=f||c(n),f.__full__=!0,tt.forEach(function(i){t[i]=function(){return o[i].apply(n,arguments)}}),d.forEach(function(i){n[i]=function(){u=!1;var n=it[i].apply(t,arguments);return u=!0,n}}),g.forEach(function(i){n[i]=function(){u&&t.valueWillMutate();var r=o[i].apply(n,arguments);return u&&t.valueHasMutated(),r}}),nt.forEach(function(f){n[f]=function(){for(var h,e=0,s=arguments.length;e<s;e++)r(arguments[e],i);return u&&t.valueWillMutate(),h=o[f].apply(n,arguments),u&&t.valueHasMutated(),h}}),n.splice=function(){for(var s,f=2,e=arguments.length;f<e;f++)r(arguments[f],i);return u&&t.valueWillMutate(),s=o.splice.apply(n,arguments),u&&t.valueHasMutated(),s},e=0,s=n.length;e<s;e++)r(n[e],i)}function r(t,r){var u,v,y,o,h;if((f&&t&&t[f]&&(r=r?r.slice(0):[],r.push(t[f])),ft(t))&&(u=t.__observable__,!u||!u.__full__)){if(u=u||c(t),u.__full__=!0,n.isArray(t))y=i.observableArray(t),e(t,y,r);else for(o in t)a(o)||u[o]||(h=Object.getPropertyDescriptor(t,o),h&&(h.get||h.set)?w(t,o,{get:h.get,set:h.set}):(v=t[o],n.isFunction(v)||s(t,o,v,r)));l&&n.log("Converted",t)}}function p(n,t,i){i?t?t.destroyAll||e(t,n):(t=[],e(t,n)):r(t);n(t)}function s(t,u,f,o){var s,l,a=t.__observable__||c(t);if(f===undefined&&(f=t[u]),n.isArray(f))s=i.observableArray(f),e(f,s,o),l=!0;else if(typeof f=="function")if(i.isObservable(f))s=f;else return null;else!h&&n.isPromise(f)?(s=i.observable(),f.then(function(t){if(n.isArray(t)){var r=i.observableArray(t);e(t,r,o);t=r}s(t)})):(s=i.observable(f),r(f,o));return o&&o.length>0&&o.forEach(function(i){n.isArray(f)?s.subscribe(function(n){i(t,u,null,n)},null,"arrayChange"):s.subscribe(function(n){i(t,u,n,null)})}),Object.defineProperty(t,u,{configurable:!0,enumerable:!0,get:s,set:i.isWriteableObservable(s)?function(t){t&&n.isPromise(t)&&!h?t.then(function(t){p(s,t,n.isArray(t))}):p(s,t,l)}:undefined}),a[u]=s,s}function w(t,r,u){var f={owner:t,deferEvaluation:!0},e;return typeof u=="function"?f.read=u:("value"in u&&n.error('For defineProperty, you must not specify a "value" for the property. You must provide a "get" function.'),typeof u.get!="function"&&typeof u.read!="function"&&n.error('For defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".'),f.read=u.get||u.read,f.write=u.set||u.write),e=i.computed(f),Object.defineProperty(t,r,{configurable:!0,enumerable:!0,value:e}),s(t,r,e)}var u,b=Object.prototype.toString,k=["[object Function]","[object String]","[object Boolean]","[object Number]","[object Date]","[object RegExp]"],d=["remove","removeAll","destroy","destroyAll","replace"],g=["pop","reverse","sort","shift","slice"],nt=["push","unshift"],tt=["filter","map","reduce","reduceRight","forEach","every","some"],o=Array.prototype,it=i.observableArray.fn,l=!1,f=undefined,h=!1,a,v,y;return"getPropertyDescriptor"in Object||(v=Object.getOwnPropertyDescriptor,y=Object.getPrototypeOf,Object.getPropertyDescriptor=function(n,t){for(var i=n,r;i&&!(r=v(i,t));)i=y(i);return r}),u=function(n,t){var u,f,r;return n?(u=n.__observable__,u&&(f=u[t],f))?f:(r=n[t],i.isObservable(r))?r:s(n,t,r):null},u.defineProperty=w,u.convertProperty=s,u.convertObject=r,u.install=function(n){var i=t.binding;t.binding=function(n,t,u){u.applyBindings&&!u.skipConversion&&r(n);i(n,t)};l=n.logConversion;n.changeDetection&&(f=n.changeDetection);h=n.skipPromises;a=n.shouldIgnorePropertyName||rt},u})